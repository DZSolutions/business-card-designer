<!DOCTYPE html>
<html>
  <head>
    <link rel="shortcut icon" href="#" />
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Business Card Design Tool" />
    <meta name="author" content="Ahmed YILMAZ" />
    <title>Business Card Generator</title>
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/fabric.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery-ui.min.js"></script>
    <script src="js/FileSaver.min.js"></script>
    <script src="js/JsBarcode.all.min.js"></script>
    <script src="js/qrcode.min.js"></script>

    <link rel="stylesheet" href="font-awesome/css/font-awesome.min.css" />

    <!-- Bootstrap core CSS -->
    <!-- <link href="css/bootstrap.min.css" rel="stylesheet" /> -->

    <!-- Custom styles for this template -->
    <!-- <link href="css/my_style.css" rel="stylesheet" /> -->
    <link href="tailwindcss/dist/tailwind.css" rel="stylesheet" />
  </head>
  <body class="bg-gray-700">
    <div class="flex justify-between mx-auto">
      <div class="flex-shrink-0 items-center p-2 pt-5">
        <div
          id="toolbox"
          class="grid grid-cols-1 gap-1 bg-white border rounded-md p-1"
          role="group"
          aria-label="..."
        >
          <button
            id="add-text"
            type="button"
            class="
              px-4
              py-4
              border border-transparent
              text-sm
              leading-4
              font-medium
              rounded-md
              shadow-sm
              text-white
              bg-indigo-600
              hover:bg-indigo-700
              focus:outline-none
              focus:ring-2
              focus:ring-offset-2
              focus:ring-indigo-500
            "
          >
            <i class="fa fa-font" aria-hidden="true" title="Add text"></i>
          </button>

          <button
            id="add-barcode"
            type="button"
            class="
              px-4
              py-4
              border border-transparent
              text-sm
              leading-4
              font-medium
              rounded-md
              shadow-sm
              text-white
              bg-indigo-600
              hover:bg-indigo-700
              focus:outline-none
              focus:ring-2
              focus:ring-offset-2
              focus:ring-indigo-500
            "
          >
            <i class="fa fa-barcode" aria-hidden="true" title="Add barcode"></i>
          </button>
          <button
            id="add-qrcode"
            type="button"
            class="
              px-4
              py-4
              border border-transparent
              text-sm
              leading-4
              font-medium
              rounded-md
              shadow-sm
              text-white
              bg-indigo-600
              hover:bg-indigo-700
              focus:outline-none
              focus:ring-2
              focus:ring-offset-2
              focus:ring-indigo-500
            "
          >
            <i class="fa fa-qrcode" aria-hidden="true" title="Add qrcode"></i>
          </button>

          <button
            id="shapes"
            type="button"
            class="
              px-4
              py-4
              border border-transparent
              text-sm
              leading-4
              font-medium
              rounded-md
              shadow-sm
              text-white
              bg-indigo-600
              hover:bg-indigo-700
              focus:outline-none
              focus:ring-2
              focus:ring-offset-2
              focus:ring-indigo-500
            "
          >
            <i
              class="fa fa-object-ungroup"
              aria-hidden="true"
              title="Shapes"
            ></i>
          </button>
          <button
            id="images"
            type="button"
            class="
              px-4
              py-4
              border border-transparent
              text-sm
              leading-4
              font-medium
              rounded-md
              shadow-sm
              text-white
              bg-indigo-600
              hover:bg-indigo-700
              focus:outline-none
              focus:ring-2
              focus:ring-offset-2
              focus:ring-indigo-500
            "
          >
            <i class="fa fa-picture-o" aria-hidden="true" title="Images"></i>
          </button>
          <button
            id="themes"
            type="button"
            class="
              px-4
              py-4
              border border-transparent
              text-sm
              leading-4
              font-medium
              rounded-md
              shadow-sm
              text-white
              bg-indigo-600
              hover:bg-indigo-700
              focus:outline-none
              focus:ring-2
              focus:ring-offset-2
              focus:ring-indigo-500
            "
          >
            <i class="fa fa-id-card-o" aria-hidden="true" title="Themes"></i>
          </button>
          <button
            id="clear"
            type="button"
            class="
              px-4
              py-4
              border border-transparent
              text-sm
              leading-4
              font-medium
              rounded-md
              shadow-sm
              text-white
              bg-indigo-600
              hover:bg-indigo-700
              focus:outline-none
              focus:ring-2
              focus:ring-offset-2
              focus:ring-indigo-500
            "
          >
            <i
              class="fa fa-trash-o"
              aria-hidden="true"
              title="Clear canvas"
            ></i>
          </button>
          <button
            id="save"
            type="button"
            class="
              px-4
              py-4
              border border-transparent
              text-sm
              leading-4
              font-medium
              rounded-md
              shadow-sm
              text-white
              bg-indigo-600
              hover:bg-indigo-700
              focus:outline-none
              focus:ring-2
              focus:ring-offset-2
              focus:ring-indigo-500
            "
          >
            <i class="fa fa-floppy-o" aria-hidden="true" title="Save"></i>
          </button>
          <button
            id="download"
            type="button"
            class="
              px-4
              py-4
              border border-transparent
              text-sm
              leading-4
              font-medium
              rounded-md
              shadow-sm
              text-white
              bg-indigo-600
              hover:bg-indigo-700
              focus:outline-none
              focus:ring-2
              focus:ring-offset-2
              focus:ring-indigo-500
            "
          >
            <i
              class="fa fa-download"
              aria-hidden="true"
              title="Save as image"
            ></i>
          </button>
        </div>
      </div>
      <div class="flex h-screen">
        <div class="canvas m-auto">
          <canvas
            id="canvas"
            width="750"
            height="450"
            class="rounded-3xl shadow-2xl"
          ></canvas>
          <script type="text/javascript">
            var canvas = new fabric.Canvas('canvas', {
              backgroundColor: '#FFFFFF',
            });
          </script>
          <div style="height: 0px; overflow: hidden">
            <input type="file" id="imgLoader" />
          </div>
          <div style="height: 0px; overflow: hidden">
            <input type="file" id="upload-bcd" />
          </div>
        </div>
      </div>
      <div class="flex p-2 flex-shrink-0">
        <div class="grid grid-cols-1 gap-4">
          <div id="properties" class="bg-white shadow rounded-lg">
            <div class="p-3 w-72">
              <h4 style="color: grey">Properties</h4>
              <div class="mt-1 rounded-md shadow-sm flex" style="display: none">
                <span
                  class="
                    bg-gray-50
                    border border-r-0 border-gray-300
                    rounded-l-md
                    px-3
                    inline-flex
                    w-44
                    items-center
                    text-gray-500 text-sm
                  "
                  id="basic-addon1"
                  >Font</span
                >
                <select
                  class="
                    focus:ring-sky-500 focus:border-sky-500
                    flex-grow
                    block
                    w-full
                    min-w-0
                    rounded-none rounded-r-md
                    text-sm
                    border-gray-300
                  "
                  id="text-font"
                >
                  <option>Helvetica</option>
                  <option>Arial</option>
                  <option>Arial Black</option>
                  <option>Comic Sans MS</option>
                  <option>Georgia</option>
                  <option>Impact</option>
                  <option>Lucida Sans Unicode</option>
                  <option>Palatino Linotype</option>
                  <option>Tahoma</option>
                  <option>Times New Roman</option>
                  <option>Trebuchet MS</option>
                  <option>Verdana</option>
                </select>
              </div>
              <div class="mt-1 rounded-md shadow-sm flex" style="display: none">
                <span
                  class="
                    bg-gray-50
                    border border-r-0 border-gray-300
                    rounded-l-md
                    px-3
                    inline-flex
                    w-44
                    items-center
                    text-gray-500 text-sm
                  "
                  id="basic-addon1"
                  >Font Size</span
                >
                <input
                  id="text-fontsize"
                  type="text"
                  class="
                    focus:ring-sky-500 focus:border-sky-500
                    flex-grow
                    block
                    w-full
                    min-w-0
                    rounded-none rounded-r-md
                    text-sm
                    border-gray-300
                  "
                  value=""
                  aria-describedby="basic-addon1"
                />
              </div>
              <div class="mt-1 rounded-md shadow-sm flex" style="display: none">
                <span
                  class="
                    bg-gray-50
                    border border-r-0 border-gray-300
                    rounded-l-md
                    px-3
                    inline-flex
                    w-44
                    items-center
                    text-gray-500 text-sm
                  "
                  id="basic-addon1"
                  >Font Weight</span
                >
                <select
                  class="
                    focus:ring-sky-500 focus:border-sky-500
                    flex-grow
                    block
                    w-full
                    min-w-0
                    rounded-none rounded-r-md
                    text-sm
                    border-gray-300
                  "
                  id="text-fontweight"
                >
                  <option selected>normal</option>
                  <option>bold</option>
                </select>
              </div>
              <div class="mt-1 rounded-md shadow-sm flex">
                <span
                  class="
                    bg-gray-50
                    border border-r-0 border-gray-300
                    rounded-l-md
                    px-3
                    inline-flex
                    w-44
                    items-center
                    text-gray-500 text-sm
                  "
                  id="basic-addon1"
                  >Width</span
                >
                <input
                  id="width"
                  type="text"
                  class="
                    focus:ring-sky-500 focus:border-sky-500
                    flex-grow
                    block
                    w-full
                    min-w-0
                    rounded-none rounded-r-md
                    text-sm
                    border-gray-300
                  "
                  value=""
                  aria-describedby="basic-addon1"
                />
              </div>
              <div class="mt-1 rounded-md shadow-sm flex">
                <span
                  class="
                    bg-gray-50
                    border border-r-0 border-gray-300
                    rounded-l-md
                    px-3
                    inline-flex
                    w-44
                    items-center
                    text-gray-500 text-sm
                  "
                  id="basic-addon1"
                  >Height</span
                >
                <input
                  id="height"
                  type="text"
                  class="
                    focus:ring-sky-500 focus:border-sky-500
                    flex-grow
                    block
                    w-full
                    min-w-0
                    rounded-none rounded-r-md
                    text-sm
                    border-gray-300
                  "
                  value=""
                  aria-describedby="basic-addon1"
                />
              </div>
              <div class="mt-1 rounded-md shadow-sm flex">
                <span
                  class="
                    bg-gray-50
                    border border-r-0 border-gray-300
                    rounded-l-md
                    px-3
                    inline-flex
                    w-44
                    items-center
                    text-gray-500 text-sm
                  "
                  id="basic-addon1"
                  >Angle</span
                >
                <input
                  id="angle"
                  type="text"
                  class="
                    focus:ring-sky-500 focus:border-sky-500
                    flex-grow
                    block
                    w-full
                    min-w-0
                    rounded-none rounded-r-md
                    text-sm
                    border-gray-300
                  "
                  value=""
                  aria-describedby="basic-addon1"
                />
              </div>
              <div class="mt-1 rounded-md shadow-sm flex">
                <span
                  class="
                    bg-gray-50
                    border border-r-0 border-gray-300
                    rounded-l-md
                    px-3
                    inline-flex
                    w-44
                    items-center
                    text-gray-500 text-sm
                  "
                  id="basic-addon1"
                  >Color</span
                >
                <input
                  id="color"
                  type="text"
                  class="
                    focus:ring-sky-500 focus:border-sky-500
                    flex-grow
                    block
                    w-full
                    min-w-0
                    rounded-none rounded-r-md
                    text-sm
                    border-gray-300
                  "
                  value=""
                  aria-describedby="basic-addon1"
                />
              </div>
              <div class="mt-10 flex justify-center" style="display: none">
                <label
                  id="bg-image"
                  class="
                    px-3
                    py-6
                    border border-transparent
                    text-sm
                    leading-4
                    font-medium
                    rounded-md
                    shadow-sm
                    text-white
                    bg-indigo-600
                    hover:bg-indigo-700
                    focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2
                    focus:ring-indigo-500
                    cursor-pointer
                  "
                >
                  Upload Background Image
                  <i class="fa fa-upload" aria-hidden="true"></i>
                  <input
                    id="bg-image-upload"
                    type="file"
                    class="hidden"
                    accept="image/*"
                  />
                </label>
              </div>

              <div class="mt-1 rounded-md shadow-sm flex">
                <span
                  class="
                    bg-gray-50
                    border border-r-0 border-gray-300
                    rounded-l-md
                    px-3
                    inline-flex
                    w-44
                    items-center
                    text-gray-500 text-sm
                  "
                  id="basic-addon1"
                  >Opacity</span
                >
                <input
                  id="opacity"
                  type="text"
                  class="
                    focus:ring-sky-500 focus:border-sky-500
                    flex-grow
                    block
                    w-full
                    min-w-0
                    rounded-none rounded-r-md
                    text-sm
                    border-gray-300
                  "
                  value=""
                  aria-describedby="basic-addon1"
                />
              </div>
            </div>
          </div>
          <!--end of properties panel-->
          <div
            id="layers"
            class="bg-white shadow rounded-lg overflow-auto max-h-96"
          >
            <div class="p-3">
              <h4 style="color: grey">Layers</h4>

              <ul class="background">
                <!-- <li onclick="deneme();"> -->
                <li onclick="">
                  <div
                    class="bg-white shadow rounded-lg border-2 border-gray-300"
                  >
                    <div class="layer p-3 flex justify-between">
                      <div>Background</div>

                      <button
                        id="canvas-props"
                        type="button"
                        class="
                          px-3
                          py-2
                          border border-transparent
                          text-sm
                          leading-4
                          font-medium
                          rounded-md
                          shadow-sm
                          text-white
                          bg-indigo-600
                          hover:bg-indigo-700
                          focus:outline-none
                          focus:ring-2
                          focus:ring-offset-2
                          focus:ring-indigo-500
                        "
                      >
                        <i class="fa fa-cog" aria-hidden="true"></i>
                      </button>
                    </div>
                  </div>
                </li>
              </ul>
              <ul id="sortable">
                <!-- Magic happens here-->
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <footer
      class="
        h-40
        w-full
        m-auto
        fixed
        bottom-0
        z-0
        flex
        justify-center
        items-center
      "
    >
      <!--Shapes Panel-->
      <div id="shapes-panel" class="footer" style="display: none">
        <div
          class="bg-white overflow-hidden shadow rounded-lg"
          style="height: 100%"
        >
          <div class="p-3">
            <div class="grid grid-flow-col auto-cols-max gap-2">
              <div class="footer-item">
                <button
                  id="add-rect"
                  type="button"
                  class="
                    inline-flex
                    items-center
                    px-3
                    py-2
                    border border-transparent
                    text-sm
                    leading-4
                    font-medium
                    rounded-md
                    shadow-sm
                    text-white
                    bg-indigo-600
                    hover:bg-indigo-700
                    focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2
                    focus:ring-indigo-500
                  "
                >
                  <i
                    style="color: #e74c3c; font-size: 80px"
                    class="fa fa-stop"
                    aria-hidden="true"
                  ></i>
                  <p>Rectangle</p>
                </button>
              </div>
              <div class="footer-item">
                <button
                  id="add-circ"
                  type="button"
                  class="
                    inline-flex
                    items-center
                    px-3
                    py-2
                    border border-transparent
                    text-sm
                    leading-4
                    font-medium
                    rounded-md
                    shadow-sm
                    text-white
                    bg-indigo-600
                    hover:bg-indigo-700
                    focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2
                    focus:ring-indigo-500
                  "
                >
                  <i
                    style="color: #3498db; font-size: 80px"
                    class="fa fa-circle"
                    aria-hidden="true"
                  ></i>
                  <p>Circle</p>
                </button>
              </div>
              <div class="footer-item">
                <button
                  id="add-tri"
                  type="button"
                  class="
                    inline-flex
                    items-center
                    px-3
                    py-2
                    border border-transparent
                    text-sm
                    leading-4
                    font-medium
                    rounded-md
                    shadow-sm
                    text-white
                    bg-indigo-600
                    hover:bg-indigo-700
                    focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2
                    focus:ring-indigo-500
                  "
                >
                  <i
                    style="
                      color: #2ecc71;
                      font-size: 80px;
                      -webkit-transform: rotate(270deg);
                    "
                    class="fa fa-play"
                    aria-hidden="true"
                  ></i>
                  <p>Triangle</p>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!--end of shapes panel-->
      <!--Images Panel-->
      <div id="images-panel" class="footer" style="display: none">
        <div
          class="bg-white overflow-hidden shadow rounded-lg"
          style="height: 100%"
        >
          <div class="p-3">
            <div class="grid grid-flow-col auto-cols-max gap-2">
              <div class="footer-item">
                <button
                  type="button"
                  class="
                    inline-flex
                    items-center
                    px-3
                    py-2
                    border border-transparent
                    text-sm
                    leading-4
                    font-medium
                    rounded-md
                    shadow-sm
                    text-white
                    bg-indigo-600
                    hover:bg-indigo-700
                    focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2
                    focus:ring-indigo-500
                  "
                  onclick="loadImage();"
                >
                  <i
                    style="font-size: 50px"
                    class="fa fa-upload"
                    aria-hidden="true"
                  ></i>
                  <h5>Upload Image</h5>
                </button>
              </div>
              <div class="footer-item">
                <button
                  type="button"
                  class="
                    inline-flex
                    items-center
                    px-3
                    py-2
                    border border-transparent
                    text-sm
                    leading-4
                    font-medium
                    rounded-md
                    shadow-sm
                    text-white
                    bg-indigo-600
                    hover:bg-indigo-700
                    focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2
                    focus:ring-indigo-500
                  "
                >
                  <i
                    style="font-size: 50px"
                    class="fa fa-phone"
                    aria-hidden="true"
                  ></i>
                </button>
              </div>
              <div class="footer-item">
                <button
                  type="button"
                  class="
                    inline-flex
                    items-center
                    px-3
                    py-2
                    border border-transparent
                    text-sm
                    leading-4
                    font-medium
                    rounded-md
                    shadow-sm
                    text-white
                    bg-indigo-600
                    hover:bg-indigo-700
                    focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2
                    focus:ring-indigo-500
                  "
                >
                  <i
                    style="font-size: 50px"
                    class="fa fa-mobile"
                    aria-hidden="true"
                  ></i>
                </button>
              </div>
              <div class="footer-item">
                <button
                  type="button"
                  class="
                    inline-flex
                    items-center
                    px-3
                    py-2
                    border border-transparent
                    text-sm
                    leading-4
                    font-medium
                    rounded-md
                    shadow-sm
                    text-white
                    bg-indigo-600
                    hover:bg-indigo-700
                    focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2
                    focus:ring-indigo-500
                  "
                >
                  <i
                    style="font-size: 50px"
                    class="fa fa-map-marker"
                    aria-hidden="true"
                  ></i>
                </button>
              </div>
              <div class="footer-item">
                <button
                  type="button"
                  class="
                    inline-flex
                    items-center
                    px-3
                    py-2
                    border border-transparent
                    text-sm
                    leading-4
                    font-medium
                    rounded-md
                    shadow-sm
                    text-white
                    bg-indigo-600
                    hover:bg-indigo-700
                    focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2
                    focus:ring-indigo-500
                  "
                >
                  <i
                    style="font-size: 50px"
                    class="fa fa-envelope-o"
                    aria-hidden="true"
                  ></i>
                </button>
              </div>
              <div class="footer-item">
                <button
                  type="button"
                  class="
                    inline-flex
                    items-center
                    px-3
                    py-2
                    border border-transparent
                    text-sm
                    leading-4
                    font-medium
                    rounded-md
                    shadow-sm
                    text-white
                    bg-indigo-600
                    hover:bg-indigo-700
                    focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2
                    focus:ring-indigo-500
                  "
                >
                  <i
                    style="font-size: 50px"
                    class="fa fa-user"
                    aria-hidden="true"
                  ></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!--end of images panel-->
      <!--Themes Panel-->
      <div id="themes-panel" class="footer">
        <div
          class="bg-white overflow-hidden shadow rounded-lg"
          style="height: 100%"
        >
          <div class="p-3">
            <div class="grid grid-flow-col auto-cols-max gap-2">
              <div class="footer-item">
                <button
                  id="load-bcd"
                  type="button"
                  class="
                    inline-flex
                    items-center
                    px-3
                    py-2
                    border border-transparent
                    text-sm
                    leading-4
                    font-medium
                    rounded-md
                    shadow-sm
                    text-white
                    bg-indigo-600
                    hover:bg-indigo-700
                    focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2
                    focus:ring-indigo-500
                  "
                >
                  <i
                    style="font-size: 50px"
                    class="fa fa-upload"
                    aria-hidden="true"
                  ></i>
                  <h5>Load your design</h5>
                </button>
              </div>
              <div class="footer-item">
                <button
                  id="lines"
                  type="button"
                  class="
                    inline-flex
                    items-center
                    px-3
                    py-2
                    border border-transparent
                    text-sm
                    leading-4
                    font-medium
                    rounded-md
                    shadow-sm
                    text-white
                    bg-indigo-600
                    hover:bg-indigo-700
                    focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2
                    focus:ring-indigo-500
                  "
                  onclick="loadTemplate('linesandshapes');"
                >
                  <img class="h-24" src="themes/linesandshapes.png" alt="" />
                  <h5>Lines & Shapes</h5>
                </button>
              </div>
              <div class="footer-item">
                <button
                  id="lacquer"
                  type="button"
                  class="
                    inline-flex
                    items-center
                    px-3
                    py-2
                    border border-transparent
                    text-sm
                    leading-4
                    font-medium
                    rounded-md
                    shadow-sm
                    text-white
                    bg-indigo-600
                    hover:bg-indigo-700
                    focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2
                    focus:ring-indigo-500
                  "
                  onclick="loadTemplate('lacquer');"
                >
                  <img class="h-24" src="themes/lacquer.png" alt="" />
                  <h5>Lacquer</h5>
                </button>
              </div>
              <div class="footer-item">
                <button
                  id="lilysmith"
                  type="button"
                  class="
                    inline-flex
                    items-center
                    px-3
                    py-2
                    border border-transparent
                    text-sm
                    leading-4
                    font-medium
                    rounded-md
                    shadow-sm
                    text-white
                    bg-indigo-600
                    hover:bg-indigo-700
                    focus:outline-none
                    focus:ring-2
                    focus:ring-offset-2
                    focus:ring-indigo-500
                  "
                  onclick="loadTemplate('lilysmith');"
                >
                  <img class="h-24" src="themes/lilysmith.png" alt="" />
                  <h5>Lily Smith</h5>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!--end of themes panel-->
    </footer>

    <script type="text/javascript">
      // window.onbeforeunload = function() {
      //   return "Data will be lost if you leave the page, are you sure?";
      // };

      $(function () {
        $('#sortable').sortable();
        $('#sortable').disableSelection();
      });

      var edit_canvas = 0;

      var global_id = 1;
      canvas.uniScaleTransform = true;
      canvas.renderAll();

      canvas.on('object:selected', onObjectSelected);

      var selected_obj = new fabric.Object();

      function onObjectSelected(e) {
        onSelectionCleared();
        selected_obj = e.target;
        selectLayer(selected_obj.get('id'));

        if (selected_obj.get('type') == 'i-text') {
          document.getElementById('text-font').parentNode.style.display = '';
          document.getElementById('text-font').value =
            e.target.get('fontFamily');
          document.getElementById('text-fontsize').parentNode.style.display =
            '';
          document.getElementById('text-fontsize').value =
            e.target.get('fontSize');
          document.getElementById('text-fontweight').parentNode.style.display =
            '';
          document.getElementById('text-fontweight').value =
            e.target.get('fontWeight');
          document.getElementById('color').value = rgb2hex(
            e.target.get('fill')
          );
          document.getElementById('color').parentNode.style.display = '';
        } else if (selected_obj.get('type') == 'image') {
          document.getElementById('color').parentNode.style.display = 'none';
        } else {
          document.getElementById('color').value = e.target.get('fill');
          document.getElementById('color').parentNode.style.display = '';
        }
        document.getElementById('width').value = Math.round(
          e.target.get('width') * e.target.get('scaleX')
        );
        document.getElementById('height').value = Math.round(
          e.target.get('height') * e.target.get('scaleY')
        );
        document.getElementById('angle').value = Math.round(
          e.target.get('angle')
        );
        document.getElementById('opacity').value = e.target.get('opacity');
      }

      canvas.on('selection:cleared', onSelectionCleared);

      function onSelectionCleared() {
        document.getElementById('text-font').parentNode.style.display = 'none';
        document.getElementById('text-fontsize').parentNode.style.display =
          'none';
        document.getElementById('text-fontweight').parentNode.style.display =
          'none';
        document.getElementById('color').parentNode.style.display = '';
        document.getElementById('color').value = '';
        document.getElementById('width').parentNode.style.display = '';
        document.getElementById('width').value = '';
        document.getElementById('height').parentNode.style.display = '';
        document.getElementById('height').value = '';
        document.getElementById('angle').parentNode.style.display = '';
        document.getElementById('angle').value = '';
        document.getElementById('opacity').parentNode.style.display = '';
        document.getElementById('opacity').value = '';
        document.getElementById('bg-image').parentNode.style.display = 'none';

        var layeritems = document.getElementsByClassName('layeritem');
        for (var i = 0; i < layeritems.length; i++) {
          layeritems[i].childNodes[0].style.backgroundColor = '#fff';
        }

        selected_obj = null;
        edit_canvas = 0;
      }

      canvas.on('object:scaling', onObjectScaled);

      function onObjectScaled(e) {
        document.getElementById('width').value = Math.round(
          e.target.get('width') * e.target.get('scaleX')
        );
        document.getElementById('height').value = Math.round(
          e.target.get('height') * e.target.get('scaleY')
        );
        document.getElementById('angle').value = Math.round(
          parseInt(e.target.get('angle'))
        );
        canvas.renderAll();
      }

      canvas.on('object:rotating', onObjectRotated);

      function onObjectRotated(e) {
        document.getElementById('angle').value = e.target.get('angle');
        canvas.renderAll();
      }

      canvas.on('object:added', onObjectAdded);
      function onObjectAdded(e) {
        // Doesn't work
        selected_obj = searchObjById(e.target.get('id'));
        canvas.setActiveObject(selected_obj);
        canvas.renderAll();
      }

      $('#text-font').on('input', function () {
        if (selected_obj != null) {
          selected_obj.set('fontFamily', $(this).val());
          canvas.renderAll();
        }
      });

      $('#text-fontsize').on('change', function () {
        if (selected_obj != null) {
          selected_obj.set('fontSize', parseInt($(this).val()));
          canvas.renderAll();
        }
      });
      $('#text-fontsize').on('blur', function () {
        if (selected_obj == canvas.getActiveObject()) {
          if (selected_obj != null) {
            document.getElementById('text-fontsize').value =
              selected_obj.get('fontSize');
          }
        }
      });

      $('#text-fontweight').on('input', function () {
        if (selected_obj != null) {
          selected_obj.set('fontWeight', $(this).val());
          canvas.renderAll();
        }
      });

      $('#width').on('change', function () {
        if (selected_obj != null) {
          selected_obj.set('width', Math.round(parseInt($(this).val())));
          canvas.renderAll();
        }
      });

      $('#width').on('blur', function () {
        if (selected_obj == canvas.getActiveObject() && selected_obj != null) {
          document.getElementById('width').value = Math.round(
            selected_obj.get('width') * selected_obj.get('scaleX')
          );
        } else {
          document.getElementById('width').value = '';
        }
      });

      $('#height').on('change', function () {
        if (selected_obj != null) {
          selected_obj.set('height', Math.round(parseInt($(this).val())));
          canvas.renderAll();
        }
      });

      $('#height').on('blur', function () {
        if (selected_obj == canvas.getActiveObject() && selected_obj != null) {
          document.getElementById('height').value = Math.round(
            selected_obj.get('height') * selected_obj.get('scaleY')
          );
        } else {
          document.getElementById('height').value = '';
        }
      });

      $('#angle').on('change', function () {
        if (selected_obj != null) {
          selected_obj.setAngle(Math.round(parseInt($(this).val())));
          canvas.renderAll();
        }
      });

      $('#angle').on('blur', function () {
        if (selected_obj == canvas.getActiveObject() && selected_obj != null) {
          document.getElementById('angle').value = Math.round(
            selected_obj.get('angle')
          );
        } else {
          document.getElementById('angle').value = '';
        }
      });

      $('#color').on('change', function () {
        if (edit_canvas == 1) {
          canvas.backgroundColor = $(this).val();
        } else {
          if (selected_obj != null) {
            selected_obj.setColor($(this).val());
          }
        }
        canvas.renderAll();
      });

      $('#color').on('blur', function () {
        if (selected_obj == canvas.getActiveObject() && selected_obj != null) {
          if (selected_obj.get('type') == 'i-text') {
            document.getElementById('color').value = rgb2hex(
              selected_obj.get('fill')
            );
          } else {
            document.getElementById('color').value = selected_obj.get('fill');
          }
        } else if (edit_canvas == 0) {
          document.getElementById('color').value = '';
        }
      });

      $('#opacity').on('change', function () {
        if (selected_obj != null) {
          selected_obj.set({
            opacity: $(this).val(),
          });
          canvas.renderAll();
        }
      });
      $('#opacity').on('blur', function () {
        if (selected_obj == canvas.getActiveObject() && selected_obj != null) {
          document.getElementById('opacity').value =
            selected_obj.get('opacity');
        } else {
          document.getElementById('opacity').value = '';
        }
      });

      document.getElementById('bg-image-upload').onchange = function loadImage(
        e
      ) {
        var file = e.target.files[0];
        var reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = function (f) {
          var data = f.target.result;
          fabric.Image.fromURL(data, function (img) {
            img.scaleToWidth(canvas.width);
            img.scaleToHeight(canvas.height);
            img.set({
              left: canvas.width / 2 - (img.width * img.scaleY) / 2,
            });
            canvas.setBackgroundImage(img);
            canvas.requestRenderAll();
          });
        };
        '#bg-image-upload'[0].value = '';
      };

      // document.getElementById("imgLoader").onchange = function handleImage(e) {
      //   var file = e.target.files[0];
      //   var reader = new FileReader();
      //   reader.onload = function (f) {
      //     var data = f.target.result;
      //     fabric.Image.fromURL(data, function (img) {
      //       var oImg = img.set({
      //         angle: 0,
      //         padding: 10,
      //         cornersize: 10,
      //         id: global_id,
      //       });
      //       canvas.centerObject(oImg);
      //       add_layer(global_id);
      //       global_id++;
      //       canvas.add(oImg);
      //       onSelectionCleared();
      //       canvas.setActiveObject(oImg);
      //       canvas.renderAll();
      //       selected_obj = oImg;
      //       var dataURL = canvas.toDataURL({ format: "png", quality: 0.8 });
      //     });
      //   };
      //   reader.readAsDataURL(file);
      //   $("#imgLoader")[0].value = "";
      // };

      //Adding Objects

      var canvas_items = []; //This array holds objects' ids added to canvas, ordered by z index.

      $('#add-rect').click(function () {
        var rect = new fabric.Rect({
          left: 100,
          top: 150,
          fill: '#e74c3c',
          width: 200,
          height: 200,
          id: global_id,
        });
        onSelectionCleared();
        canvas.add(rect);
        add_layer(global_id);
        global_id++;
        selected_obj = rect;
        canvas.renderAll();
      });

      $('#add-circ').click(function () {
        var circ = new fabric.Circle({
          left: 100,
          top: 150,
          fill: '#3498db',
          radius: 100,
          id: global_id,
        });
        canvas.add(circ);
        onSelectionCleared();
        canvas.setActiveObject(circ);
        canvas.renderAll();
        selected_obj = circ;
        add_layer(global_id);
        global_id++;
      });

      $('#add-tri').click(function () {
        var triangle = new fabric.Triangle({
          left: 100,
          top: 150,
          fill: '#2ecc71',
          width: 200,
          height: 200,
          id: global_id,
        });
        canvas.add(triangle);
        onSelectionCleared();
        canvas.setActiveObject(triangle);
        canvas.renderAll();
        selected_obj = triangle;
        add_layer(global_id);
        global_id++;
      });

      //Toolbox

      $('#add-text').click(function () {
        var text = new fabric.IText('Click to edit text...', {
          left: 100,
          top: 100,
          fontFamily: 'Helvetica',
          fontSize: 32,
          id: global_id,
        });
        canvas.add(text);
        onSelectionCleared();
        canvas.renderAll();
        canvas.discardActiveObject();
        selected_obj = text;
        add_layer(global_id);
        global_id++;
      });

      $('#add-barcode').click(function () {
        var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
        JsBarcode(svg, 'Example 1234', {
          background: '#ffffff',
          lineColor: '#000000',
          format: 'CODE128',
          displayValue: true,
        });
        // Removes the font style because fabric has parse errors
        var text = svg.getElementsByTagName('text')[0];
        var styl = text.getAttribute('style');

        console.log(text);
        svg.getElementsByTagName('text')[0].setAttribute('style', '');
        console.log(styl);
        console.log(svg);

        fabric.loadSVGFromString(svg.outerHTML, (objects, options) => {
          barcode = new fabric.util.groupSVGElements(objects, options);
          canvas.add(barcode);
          onSelectionCleared();
          canvas.renderAll();
          canvas.discardActiveObject();
          selected_obj = barcode;
          add_layer(global_id);
          global_id++;
        });
      });

      $('#add-qrcode').click(function () {
        let data =
          'https://webisora.com';
        var svg = new QRCode({
          content: data,
          padding: 2,
          width: 128,
          height: 128,
          color: '#000000',
          background: '#ffffff',
          ecl: 'M',
        }).svg();

        //console.log(svg);

        fabric.loadSVGFromString(svg, (objects, options) => {
          qr = new fabric.util.groupSVGElements(objects, options);
          canvas.add(qr);
          onSelectionCleared();
          canvas.renderAll();
          canvas.discardActiveObject();
          selected_obj = qr;
          add_layer(global_id);
          global_id++;
        });
      });

      $('#shapes').click(function () {
        document.getElementById('shapes-panel').style.display = 'block';
        document.getElementById('images-panel').style.display = 'none';
        document.getElementById('themes-panel').style.display = 'none';
      });

      $('#images').click(function () {
        document.getElementById('images-panel').style.display = 'block';
        document.getElementById('shapes-panel').style.display = 'none';
        document.getElementById('themes-panel').style.display = 'none';
      });

      $('#themes').click(function () {
        document.getElementById('images-panel').style.display = 'none';
        document.getElementById('shapes-panel').style.display = 'none';
        document.getElementById('themes-panel').style.display = 'block';
      });

      function loadImage() {
        $('#imgLoader').click();
      }

      document.getElementById('imgLoader').onchange = function handleImage(e) {
        var file = e.target.files[0];
        var reader = new FileReader();
        reader.onload = function (f) {
          var data = f.target.result;
          fabric.Image.fromURL(data, function (img) {
            var oImg = img.set({
              angle: 0,
              padding: 10,
              cornersize: 10,
              id: global_id,
            });
            canvas.centerObject(oImg);
            add_layer(global_id);
            global_id++;
            canvas.add(oImg);
            onSelectionCleared();
            canvas.setActiveObject(oImg);
            canvas.renderAll();
            selected_obj = oImg;
            var dataURL = canvas.toDataURL({ format: 'png', quality: 0.8 });
          });
        };
        reader.readAsDataURL(file);
        $('#imgLoader')[0].value = '';
      };

      $('#clear').click(function () {
        var buttons = document.getElementsByClassName('delete-layer');
        var count = buttons.length;
        for (var i = 0; i < count; i++) {
          buttons[0].parentNode.parentNode.parentNode.remove();
        }
        global_id = 1;
        canvas.clear();
        canvas.backgroundColor = '#FFFFFF';
        onSelectionCleared();
        canvas.renderAll();
      });

      $('#save').click(function () {
        var jsonObj = canvas.toJSON(['id']);

        var layersArr = [];
        var layeritems = document.getElementsByClassName('layeritem');
        for (var i = 0; i < layeritems.length; i++) {
          layersArr.push({
            layertitle:
              layeritems[i].childNodes[0].childNodes[0].childNodes[0]
                .textContent,
            id: layeritems[i].getAttribute('id'),
          });
        }
        jsonObj.Layers = layersArr;

        var json = JSON.stringify(jsonObj);
        var blob = new Blob([json], { type: 'application/json' });
        var url = URL.createObjectURL(blob);

        var a = document.createElement('a');
        a.download = 'my-business-card.bcd';
        a.href = url;
        a.click();
      });

      $('#load-bcd').click(function () {
        $('#upload-bcd').click();
      });

      $('#upload-bcd').change(function (e) {
        onChange(e);
      });

      function onChange(event) {
        var reader = new FileReader();
        reader.onload = onReaderLoad;
        reader.readAsText(event.target.files[0]);
      }

      function onReaderLoad(event) {
        var obj = JSON.parse(event.target.result);
        $('#upload-bcd')[0].value = '';
        $('#clear').click();

        global_id = 1;
        for (var i = 0; i < obj.Layers.length; i++) {
          add_layer(obj.Layers[i].id, true);
          if (global_id <= obj.Layers[i].id) {
            global_id = obj.Layers[i].id;
          }
        }
        global_id++;
        delete obj.Layers;

        canvas.loadFromJSON(obj);
        canvas.renderAll();
      }

      $('#download').click(function () {
        canvas.discardActiveObject();
        canvas.renderAll();
        $('#canvas')
          .get(0)
          .toBlob(function (blob) {
            saveAs(blob, 'my-business-card.png');
          });
      });

      //Layer Operations

      $('#canvas-props').click(function () {
        canvas.discardActiveObject();
        canvas.renderAll();
        edit_canvas = 1;

        document.getElementById('text-font').parentNode.style.display = 'none';
        document.getElementById('text-fontsize').parentNode.style.display =
          'none';
        document.getElementById('width').parentNode.style.display = 'none';
        document.getElementById('height').parentNode.style.display = 'none';
        document.getElementById('angle').parentNode.style.display = 'none';
        document.getElementById('opacity').parentNode.style.display = 'none';

        document.getElementById('color').value = canvas.backgroundColor;
        document.getElementById('bg-image').parentNode.style.display = '';
      });

      function add_layer(id, loading) {
        var li = document.createElement('LI');
        li.setAttribute('id', id);
        li.setAttribute('class', 'layeritem pt-2');
        var div = document.createElement('DIV');
        div.setAttribute(
          'class',
          'bg-white shadow rounded-lg border-2 border-gray-300'
        );
        var innerdiv = document.createElement('DIV');
        innerdiv.setAttribute('class', 'layer p-3 flex justify-between');
        var layer_name = document.createTextNode('Layer ' + id);

        var span = document.createElement('SPAN');
        span.setAttribute('for', 'layer' + id);
        span.setAttribute('class', 'clickMe');
        var input = document.createElement('INPUT');
        input.setAttribute('type', 'text');
        input.setAttribute('value', '');
        input.setAttribute('id', 'layer' + id);
        input.setAttribute('class', 'blur');
        input.style.display = 'none';
        var delete_btn = document.createElement('BUTTON');
        delete_btn.setAttribute('id', id);
        delete_btn.setAttribute('type', 'button');
        delete_btn.setAttribute(
          'class',
          'delete-layer inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500'
        );
        var i = document.createElement('I');
        i.setAttribute('class', 'fa fa-trash');
        i.setAttribute('aria-hidden', 'true');

        delete_btn.appendChild(i);
        span.appendChild(layer_name);
        innerdiv.appendChild(span);
        innerdiv.appendChild(input);
        innerdiv.appendChild(delete_btn);
        div.appendChild(innerdiv);
        li.appendChild(div);
        if (loading == true) {
          document.getElementById('sortable').appendChild(li);
        } else {
          document
            .getElementById('sortable')
            .insertBefore(li, document.getElementById('sortable').firstChild);
        }

        $('.clickMe').click(function () {
          'use strict';
          $(this).hide();
          $('#' + $(this).attr('for'))
            .val($(this).text())
            .toggleClass(
              'focus:ring-sky-500 focus:border-sky-500 flex-grow block w-full min-w-0 rounded-none rounded-r-md text-sm border-gray-300'
            )
            .show()
            .focus();
        });

        $('.blur').blur(function () {
          'use strict';
          $(this)
            .hide()
            .toggleClass(
              'focus:ring-sky-500 focus:border-sky-500 flex-grow block w-full min-w-0 rounded-none rounded-r-md text-sm border-gray-300'
            );
          $('span[for=' + this.id + ']')
            .text($(this).val())
            .show();
        });

        var layeritems = document.getElementsByClassName('layeritem');
        for (var i = 0; i < layeritems.length; i++) {
          layeritems[i].onclick = function () {
            selected_obj = searchObjById(this.id);
            selectLayer(selected_obj.get('id'));
            canvas.setActiveObject(selected_obj);
            canvas.renderAll();
          };
        }

        var buttons = document.getElementsByClassName('delete-layer');
        for (var i = 0; i < buttons.length; i++) {
          buttons[i].onclick = function () {
            this.parentNode.parentNode.parentNode.remove();
            canvas.remove(searchObjById(this.id));
            canvas.renderAll();
          };
        }
      }

      function searchObjById(id) {
        var objs = canvas.getObjects();
        for (var i = 0; i < objs.length; i++) {
          if (objs[i].get('id') == id) {
            return objs[i];
          }
        }
      }

      //Delete layer through keyboard
      $('html').keyup(function (e) {
        if (e.keyCode == 46) {
          if (canvas.getActiveObject().get('type') != 'i-text') {
            var buttons = document.getElementsByClassName('delete-layer');
            for (var i = 0; i < buttons.length; i++) {
              if (
                buttons[i].getAttribute('id') ==
                canvas.getActiveObject().get('id')
              ) {
                buttons[i].parentNode.parentNode.parentNode.remove();
              }
            }
            canvas.remove(canvas.getActiveObject());
          }
        }
      });

      //Layer Sort Z-index
      $(document).ready(function () {
        $('#sortable').sortable({
          stop: function (event, ui) {
            canvas_items = $('#sortable').sortable('toArray', {
              attribute: 'id',
            });
            canvas_items.reverse();
            for (var i = 0; i < canvas_items.length; i++) {
              canvas.moveTo(searchObjById(canvas_items[i]), i + 1);
            }
          },
        });
      });

      $('#shapes-panel').click(function () {
        canvas.discardActiveObject();
        canvas.renderAll();
      });
      $('#images-panel').click(function () {
        canvas.discardActiveObject();
        canvas.renderAll();
      });
      $('#themes-panel').click(function () {
        canvas.discardActiveObject();
        canvas.renderAll();
      });

      //Selected objects layer gets highlighted
      function selectLayer(id) {
        var layeritems = document.getElementsByClassName('layeritem');
        for (var i = 0; i < layeritems.length; i++) {
          if (id == layeritems[i].getAttribute('id')) {
            layeritems[i].childNodes[0].style.backgroundColor = '#eee';
          }
        }
      }

      //RGB to HEX
      function rgb2hex(rgb) {
        rgb = rgb.match(
          /^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i
        );
        return rgb && rgb.length === 4
          ? '#' +
              ('0' + parseInt(rgb[1], 10).toString(16)).slice(-2) +
              ('0' + parseInt(rgb[2], 10).toString(16)).slice(-2) +
              ('0' + parseInt(rgb[3], 10).toString(16)).slice(-2)
          : '';
      }
      function loadTemplate(template) {
        var linesandshapes = {
          objects: [
            {
              type: 'rect',
              originX: 'left',
              originY: 'top',
              left: -46.75,
              top: 359.62,
              width: 8,
              height: 200,
              fill: '#43D785',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 1,
              scaleY: 1,
              angle: -45,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              rx: 0,
              ry: 0,
              id: 7,
            },
            {
              type: 'rect',
              originX: 'left',
              originY: 'top',
              left: -28.42,
              top: 317.94,
              width: 8,
              height: 250,
              fill: '#43D785',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 1,
              scaleY: 1,
              angle: -45,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              rx: 0,
              ry: 0,
              id: 6,
            },
            {
              type: 'rect',
              originX: 'left',
              originY: 'top',
              left: -9.1,
              top: 274.26,
              width: 8,
              height: 300,
              fill: '#43D785',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 1,
              scaleY: 1,
              angle: -45,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              rx: 0,
              ry: 0,
              id: 5,
            },
            {
              type: 'rect',
              originX: 'left',
              originY: 'top',
              left: 17.37,
              top: 237.5,
              width: 8,
              height: 400,
              fill: '#43D785',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 1,
              scaleY: 1,
              angle: -45,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              rx: 0,
              ry: 0,
              id: 4,
            },
            {
              type: 'rect',
              originX: 'left',
              originY: 'top',
              left: 53.25,
              top: 207.62,
              width: 8,
              height: 400,
              fill: '#43D785',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 1,
              scaleY: 1,
              angle: -45,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              rx: 0,
              ry: 0,
              id: 3,
            },
            {
              type: 'triangle',
              originX: 'left',
              originY: 'top',
              left: 623.14,
              top: -85.98,
              width: 300,
              height: 150,
              fill: '#43D785',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 1,
              scaleY: 1,
              angle: 45,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              id: 1,
            },
            {
              type: 'i-text',
              originX: 'left',
              originY: 'top',
              left: 481.02,
              top: 258,
              width: 214.89,
              height: 40.68,
              fill: 'rgb(0,0,0)',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 1.11,
              scaleY: 1.01,
              angle: 0,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              text: 'H A I R  S A L O N',
              fontSize: 36,
              fontWeight: 'normal',
              fontFamily: 'Impact',
              fontStyle: 'normal',
              lineHeight: 1.16,
              underline: false,
              overline: false,
              linethrough: false,
              textAlign: 'left',
              textBackgroundColor: '',
              charSpacing: 0,
              id: 9,
              styles: {},
            },
            {
              type: 'i-text',
              originX: 'left',
              originY: 'top',
              left: 386.02,
              top: 40,
              width: 272.72,
              height: 170.86,
              fill: 'rgb(0,0,0)',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 1.23,
              scaleY: 1.22,
              angle: 0,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              text: 'L I N E S  &\nS H A P E S',
              fontSize: 70,
              fontWeight: 'normal',
              fontFamily: 'Impact',
              fontStyle: 'normal',
              lineHeight: 1.16,
              underline: false,
              overline: false,
              linethrough: false,
              textAlign: 'left',
              textBackgroundColor: '',
              charSpacing: 0,
              id: 8,
              styles: {},
            },
            {
              type: 'triangle',
              originX: 'left',
              originY: 'top',
              left: -148.34,
              top: 138.21,
              width: 400,
              height: 200,
              fill: '#000',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 1,
              scaleY: 1,
              angle: -45,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              id: 2,
            },
          ],
          background: '#FFFFFF',
          Layers: [
            { layertitle: 'Black Triangle', id: '2' },
            { layertitle: 'Lines & Shapes', id: '8' },
            { layertitle: 'Hair Salon', id: '9' },
            { layertitle: 'Green Triangle', id: '1' },
            { layertitle: 'Layer 3', id: '3' },
            { layertitle: 'Layer 4', id: '4' },
            { layertitle: 'Layer 5', id: '5' },
            { layertitle: 'Layer 6', id: '6' },
            { layertitle: 'Layer 7', id: '7' },
          ],
        };

        var lacquer = {
          objects: [
            {
              type: 'rect',
              originX: 'left',
              originY: 'top',
              left: -240.49,
              top: 127.05,
              width: 200,
              height: 200,
              fill: '#FFA7AF',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 4.87,
              scaleY: 1.98,
              angle: 330,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              rx: 0,
              ry: 0,
              id: 1,
            },
            {
              type: 'rect',
              originX: 'left',
              originY: 'top',
              left: -40.79,
              top: 465.71,
              width: 900,
              height: 200,
              fill: '#C1FCF7',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 2.82,
              scaleY: 1.89,
              angle: 330,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              rx: 0,
              ry: 0,
              id: 2,
            },
            {
              type: 'rect',
              originX: 'left',
              originY: 'top',
              left: 154.02,
              top: 109,
              width: 200,
              height: 200,
              fill: '#FFFFFF',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 2.11,
              scaleY: 1.22,
              angle: 0,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              rx: 0,
              ry: 0,
              id: 3,
            },
            {
              type: 'i-text',
              originX: 'left',
              originY: 'top',
              left: 268,
              top: 190,
              width: 215.36,
              height: 67.8,
              fill: '#FFA7AF',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 1,
              scaleY: 1,
              angle: 0,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              text: 'Lacquer',
              fontSize: 60,
              fontWeight: 'normal',
              fontFamily: 'Georgia',
              fontStyle: 'normal',
              lineHeight: 1.16,
              underline: false,
              overline: false,
              linethrough: false,
              textAlign: 'left',
              textBackgroundColor: '',
              charSpacing: 0,
              id: 7,
              styles: {},
            },
            {
              type: 'i-text',
              originX: 'left',
              originY: 'top',
              left: 338.02,
              top: 156,
              width: 61.13,
              height: 22.6,
              fill: '#121212',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 1.18,
              scaleY: 1,
              angle: 0,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              text: 'N A I L',
              fontSize: 20,
              fontWeight: 'normal',
              fontFamily: 'Helvetica',
              fontStyle: 'normal',
              lineHeight: 1.16,
              underline: false,
              overline: false,
              linethrough: false,
              textAlign: 'left',
              textBackgroundColor: '',
              charSpacing: 0,
              id: 8,
              styles: {},
            },
            {
              type: 'i-text',
              originX: 'left',
              originY: 'top',
              left: 326,
              top: 286,
              width: 90.03,
              height: 22.6,
              fill: '#121212',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 1.14,
              scaleY: 1,
              angle: 0,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              text: 'S A L O N',
              fontSize: 20,
              fontWeight: 'normal',
              fontFamily: 'Helvetica',
              fontStyle: 'normal',
              lineHeight: 1.16,
              underline: false,
              overline: false,
              linethrough: false,
              textAlign: 'left',
              textBackgroundColor: '',
              charSpacing: 0,
              id: 9,
              styles: {},
            },
          ],
          background: '#FFFFFF',
          Layers: [
            { layertitle: 'Layer 9', id: '9' },
            { layertitle: 'Layer 8', id: '8' },
            { layertitle: 'Layer 7', id: '7' },
            { layertitle: 'Layer 3', id: '3' },
            { layertitle: 'Layer 2', id: '2' },
            { layertitle: 'Layer 1', id: '1' },
          ],
        };

        var lilysmith = {
          objects: [
            {
              type: 'rect',
              originX: 'left',
              originY: 'top',
              left: 365.02,
              top: 58,
              width: 320,
              height: 320,
              fill: '#F7C8C4',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 1.03,
              scaleY: 1,
              angle: 0,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              rx: 0,
              ry: 0,
              id: 1,
            },
            {
              type: 'i-text',
              originX: 'left',
              originY: 'top',
              left: 169,
              top: 111,
              width: 298.04,
              height: 219.67,
              fill: '#333333',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 0.91,
              scaleY: 0.84,
              angle: 0,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              text: 'LILY\nSMITH',
              fontSize: 90,
              fontWeight: 'normal',
              fontFamily: 'Georgia',
              fontStyle: 'normal',
              lineHeight: 1.16,
              underline: false,
              overline: false,
              linethrough: false,
              textAlign: 'left',
              textBackgroundColor: '',
              charSpacing: 0,
              id: 2,
              styles: {},
            },
            {
              type: 'i-text',
              originX: 'left',
              originY: 'top',
              left: 173,
              top: 310,
              width: 160.85,
              height: 27.12,
              fill: '#333333',
              stroke: null,
              strokeWidth: 1,
              strokeDashArray: null,
              strokeLineCap: 'butt',
              strokeLineJoin: 'miter',
              strokeMiterLimit: 10,
              scaleX: 1.06,
              scaleY: 1,
              angle: 0,
              flipX: false,
              flipY: false,
              opacity: 1,
              shadow: null,
              visible: true,
              clipTo: null,
              backgroundColor: '',
              fillRule: 'nonzero',
              globalCompositeOperation: 'source-over',
              transformMatrix: null,
              skewX: 0,
              skewY: 0,
              text: 'makeup artist',
              fontSize: 24,
              fontWeight: 'normal',
              fontFamily: 'Lucida Sans Unicode',
              fontStyle: 'normal',
              lineHeight: 1.16,
              underline: false,
              overline: false,
              linethrough: false,
              textAlign: 'left',
              textBackgroundColor: '',
              charSpacing: 0,
              id: 3,
              styles: {},
            },
          ],
          background: '#FFFFFF',
          Layers: [
            { layertitle: 'Layer 3', id: '3' },
            { layertitle: 'Layer 2', id: '2' },
            { layertitle: 'Layer 1', id: '1' },
          ],
        };

        var obj = '';
        switch (template) {
          case 'linesandshapes':
            obj = linesandshapes;
            break;
          case 'lacquer':
            obj = lacquer;
            break;
          case 'lilysmith':
            obj = lilysmith;
            break;
        }
        $('#clear').click();

        global_id = 1;
        for (var i = 0; i < obj.Layers.length; i++) {
          add_layer(obj.Layers[i].id, true);
          if (global_id <= obj.Layers[i].id) {
            global_id = obj.Layers[i].id;
          }
        }
        global_id++;
        delete obj.Layers;

        canvas.loadFromJSON(obj);
        canvas.renderAll();
        obj = '';
      }
    </script>
  </body>
</html>
